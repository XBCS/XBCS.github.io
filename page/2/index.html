<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <meta http-equiv="X-UA-Compatible" content="IE=edge" >
  <title>丶信步沧桑</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="闭上双眼, 感觉你就在身边.">
<meta property="og:type" content="website">
<meta property="og:title" content="丶信步沧桑">
<meta property="og:url" content="http://xbcs.github.io/page/2/index.html">
<meta property="og:site_name" content="丶信步沧桑">
<meta property="og:description" content="闭上双眼, 感觉你就在身边.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="丶信步沧桑">
<meta name="twitter:description" content="闭上双眼, 感觉你就在身边.">
  
    <link rel="alternative" href="/atom.xml" title="丶信步沧桑" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="null" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">Zoe Lee</a></h1>
		</hgroup>

		
		<p class="header-subtitle">The more you learn, the more you feel you are ignorant.</p>
		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
						<div class="icon-wrap icon-me hide" data-idx="3">
							<div class="user"></div>
							<div class="shoulder"></div>
						</div>
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>Menu</li>
						<li>Tags</li>
						
						<li>Links</li>
						
						
						<li>Über</li>
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Core-Animation/" style="font-size: 20px;">Core Animation</a> <a href="/tags/FMDB-iOS/" style="font-size: 10px;">FMDB iOS</a> <a href="/tags/OC-知识点-随记/" style="font-size: 10px;">OC 知识点 随记</a> <a href="/tags/React-Native-热更新-iOS/" style="font-size: 15px;">React-Native 热更新 iOS</a> <a href="/tags/objc-OC-Runtime/" style="font-size: 10px;">objc OC Runtime</a> <a href="/tags/吐槽-杂-Bug-ScrollView-Masonry-AutoLayout/" style="font-size: 10px;">吐槽 杂 Bug ScrollView Masonry AutoLayout</a>
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">奥巴马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">卡卡的美丽传说</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">本泽马的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">吉格斯的博客</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">习大大大不同</a>
			        
			          <a target="_blank" class="main-nav-link switch-friends-link" href="http://localhost:4000/">托蒂的博客</a>
			        
			        </div>
				</section>
				

				
				
				<section class="switch-part switch-part4">
				
					<div id="js-aboutme">我是谁，我从哪里来，我到哪里去？我就是我，是颜色不一样的吃货…</div>
				</section>
				
			</div>
		</div>
	</header>				
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">Zoe Lee</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
			
				<img lazy-src="null" class="js-avatar">
			
			</div>
			<hgroup>
			  <h1 class="header-author">Zoe Lee</h1>
			</hgroup>
			
			<p class="header-subtitle">The more you learn, the more you feel you are ignorant.</p>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>

      <div class="body-wrap">
  
    <article id="post-React-Native代码结构" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/17/React-Native代码结构/" class="article-date">
  	<time datetime="2016-04-17T06:55:22.000Z" itemprop="datePublished">2016-04-17</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/17/React-Native代码结构/">React-Native结构</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1>一:了解index.iOS.js</h1>

<p>大家都清楚，React-Native就是在开发效率和用户体验间做的一种权衡。React-native是使用JS开发，开发效率高、发布能力强，不仅拥有hybrid的开发效率，同时拥有native app相媲美的用户体验。目前天猫也在这块开始试水。</p>
<p>用编辑器打开index.ios.js文件，分析代码结构：</p>
<ol>
<li><p>第一句：<code>var React = require(&#39;react-native&#39;);</code></p>
<pre><code>有Node.js开发经验的同学都清楚，require可以引入其他模块。如果没有node.js
开发经验的同学，可以脑补下java的import和c++的#include。
</code></pre></li>
<li><p>第二句代码，批量定义组件：</p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> &#123;</span><br><span class="line">    AppRegistry,</span><br><span class="line">    StyleSheet,</span><br><span class="line">    Text,</span><br><span class="line">    View,</span><br><span class="line">&#125; = React;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>其实，这只是一个语法糖而已，比如AppRegistry我们可以这样定义：<code>var AppRegistry = React.AppRegistry;</code></p>
<ol>
<li><p>构建Heollo World入口类。</p>
<pre><code>React提供了React.createClass的方法创建一个类。里面的render方法就是渲染视图用的。return返回的是视图的模板代码。其实这是JSX的模板语法，可以提前学习下。
</code></pre></li>
<li><p>相对于web开发，我们需要提供视图的样式，那么StyleSheet.create就是干这件事的，只是用JS的自面量表达了css样式。</p>
</li>
<li><p>如何引入css样式？</p>
<pre><code>其实在render方法返回的视图模板里已经体现出来了，即style={styles.container}.
其中style是视图的一个属性，styles是我们定义的样式表，container是样式表中的一个样式。
</code></pre></li>
<li>注册应用入口，这个一定不能少，否则模拟器会提示报错：<br> <code>AppRegistry.registerComponent(&#39;HelloWorld&#39;, () =&gt; HelloWorld);</code></li>
</ol>
<h1>二:需要的知识</h1><br>对于React-Native开发，仅仅有基础前端开发的知识是不够的，你还需要了解和掌握的有：<br><br><em> Node.js基础
</em> JSX语法基础<br>* Flexbox布局<br><br><h1>需要关注的文件</h1>

<ol>
<li>目前阶段有几个文件时需要注意下的：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1&gt; 在xcode项目代码中AppDelegate.m会标识入口文件，例如：jsCodeLocation = [NSURL URLWithString:@&quot;http://localhost:8081/index.ios.bundle&quot;];</span><br><span class="line">如果是网上下载别人的源码，注意此处的ip和端口是否有被修改。</span><br><span class="line"></span><br><span class="line">2&gt;闪屏界面在哪修改？在xcode项目中找到LaunchScreen.xib文件，点击，你会看到界面，这个就是启动界面，你手动添加组件或者修改文本即可，最好了解下xcode的使用。</span><br><span class="line"></span><br><span class="line">3&gt;文本编辑器打开index.ios.js文件，是js代码的入口文件，所有的代码编写从这开始，可以定义自己的模块和引入第三方模块。</span><br></pre></td></tr></table></figure>
<h1>四:修改文件index.ios.js</h1>

<ol>
<li><p>修改启动界面，如下图<br><img src="https://raw.githubusercontent.com/XBCS/img/master/React-Native/2_1.png" alt="启动界面"></p>
</li>
<li><p>添加图片和修改样式.</p>
<p> 我们在第一篇的demo基础上修改。去掉第二个和第三个<text>,增加我们需要的图片，因为图片更具表达力，就像最近的图片社交应用很火一样。</text></p>
 <figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>&gt; 添加Image组件，将代码修改成如下即可：</span><br><span class="line"><span class="keyword">var</span> &#123;</span><br><span class="line">    StyleSheet,</span><br><span class="line">    Text,</span><br><span class="line">    View,</span><br><span class="line">    Image,</span><br><span class="line">&#125; = React;</span><br><span class="line"></span><br><span class="line">    <span class="number">2</span>&gt; 将render返回中的模版增加Image组件视图，具体如下：</span><br><span class="line">render: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        &lt;View style=&#123;styles.container&#125;&gt;</span><br><span class="line">            &lt;Text style=&#123;styles.welcome&#125;&gt;</span><br><span class="line">                React-Native入门学习</span><br><span class="line">            &lt;/Text&gt;</span><br><span class="line">            &lt;Image style=&#123;styles.pic&#125; source=&#123;&#123;uri: 'https://avatars3.githubusercontent.com/u/6133685?v=3&amp;s=460'&#125;&#125;&gt;</span><br><span class="line">            &lt;/Image&gt;</span><br><span class="line">        &lt;/View&gt;</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line">其中，Image标签的source的第一个大括号是模板，第二个大括号是js对象，js对象里面有个key是uri,表示图片的地址。</span><br><span class="line"></span><br><span class="line">    <span class="number">3</span>&gt; 修改图片视图的样式，删除多余的样式，增加pic样式：</span><br><span class="line"><span class="keyword">var</span> styles = StyleSheet.create(&#123;</span><br><span class="line">    container: &#123;</span><br><span class="line">        flex: <span class="number">1</span>,</span><br><span class="line">        justifyContent: <span class="string">'center'</span>,</span><br><span class="line">        alignItems: <span class="string">'center'</span>,</span><br><span class="line">        backgroundColor: <span class="string">'#F5FCFF'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    welcome: &#123;</span><br><span class="line">        fontSize: <span class="number">20</span>,</span><br><span class="line">        textAlign: <span class="string">'center'</span>,</span><br><span class="line">        margin: <span class="number">10</span>,</span><br><span class="line">        color: <span class="string">'red'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    pic: &#123;</span><br><span class="line">        width:<span class="number">100</span>,</span><br><span class="line">        height:<span class="number">100</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line">    <span class="number">4</span>&gt; 可以cmd + Q 停止模拟器，然后再cmd + R开启模拟器，你会发现启动界面和首页都你想要的样子：</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p><img src="https://raw.githubusercontent.com/XBCS/img/master/React-Native/2_2.png" alt="首页"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React-Native-热更新-iOS/">React-Native 热更新 iOS</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-React-Native初识" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/04/14/React-Native初识/" class="article-date">
  	<time datetime="2016-04-14T14:25:13.000Z" itemprop="datePublished">2016-04-14</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/04/14/React-Native初识/">React-Native初识</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2>React-Native初识</h2>

<h3>前提</h3><br><em> Node.js基础
</em> JSX语法基础<br>* Flexbox布局<br><br><br><h3>环境配置</h3>


<ol>
<li>安装<a href="https://nodejs.org/en/download/" target="_blank" rel="external">node.js</a>下载mac版<br></li>
<li>获取Homebrew.打开终端输入下列命令:<br><code>/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;</code><br> 若提示缺少组件,输入 <code>brew install wget</code><br></li>
<li>建议安装watchman，终端命令：<code>brew install watchman</code><br></li>
<li>安装flow,终端命令:<code>brew install flow</code></li>
</ol>
<p>通过以上步骤可配置好环境</p>
<p></p><h3>第一个React-Native终端项目</h3><p></p>
<ol>
<li>安装命令行工具,终端:<code>sudo npm install -g react-native-cli</code><br></li>
<li>进入你想要的目录,创建项目: <code>react-native init &lt;项目名&gt;</code> 如:<code>react-native init HelloWorld</code> ca,第一次真慢,尼玛10多分钟了<br></li>
<li>进入目录打开&lt;项目名&gt;.xcodeproj<br>运行 如下图:</li>
</ol>
<p><img src="https://raw.githubusercontent.com/XBCS/img/master/React-Native/1_1.png" alt="1_1"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React-Native-热更新-iOS/">React-Native 热更新 iOS</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-简单学习FMDB" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2016/03/23/简单学习FMDB/" class="article-date">
  	<time datetime="2016-03-23T15:05:19.000Z" itemprop="datePublished">2016-03-23</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2016/03/23/简单学习FMDB/">FMDB</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3>FMDB</h3>

<p>FMDB学习还是直接看源码更好,这里只是做一点简单的学习和翻译工作<a href="https://github.com/ccgus/fmdb" target="_blank" rel="external">FMDB GIT 源码</a>;</p>
<h3>FMDB有三个主要的类</h3>

<ul>
<li><p><code>&lt;FMDatabase&gt;</code> 是用来执行SQL语句的类,是一个单一的SQLite数据库</p>
</li>
<li><p><code>&lt;FMResultSet&gt;</code>  是一个用FMDatabase类执行查询语句后返回的结果集</p>
</li>
<li><code>&lt;FMDatabaseQueue&gt;</code> 在多线程执行查询和更新时使用的类.</li>
</ul>
<h3>创建数据库</h3>

<p>创建数据库需要指定一个唯一路径作为SQLite数据库的目录.<br>这个路径可以是下面三种情况之一:</p>
<ul>
<li>文件路径,这个路径可以不存在,如果不存在则会创建一个给你</li>
<li>可以是空字符串<code>&lt;@&quot;&quot;&gt;</code>.传入空字符串会在临时目录创建一个空数据库,当<code>FMDatabase</code>连接关闭时,会自动删除这个数据库</li>
<li>可以传<code>nil</code>,会在内存中创建一个数据库.当<code>FMDatabase</code>连接关闭时,会自动删除这个数据库.</li>
</ul>
<h5>路径</h5>


<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">NSString *docsPath = NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES).lastObject;</span><br><span class="line"></span><br><span class="line">NSString *dbPath = [docsPath stringByAppendingPathComponent:@"test.db"];</span><br><span class="line"></span><br><span class="line">FMDatabase *db = [FMDatabase databaseWithPath:dbPath];</span><br><span class="line"></span><br><span class="line">//访问修改数据库必须保证数据库是打开的,这样才能保证数据库的读写.</span><br><span class="line"></span><br><span class="line">//打开数据库,如果没有,会创建一个数据库.</span><br><span class="line">if(![db open]) &#123;</span><br><span class="line">    </span><br><span class="line">    return;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3>Demo</h3>


<p><a href="https://github.com/XBCS/FMDBDemo" target="_blank" rel="external">Demo链接</a></p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br></pre></td><td class="code"><pre><span class="line">//创建单表,简单demo.若数据庞大有依赖关系,通常为了方便管理,会创建多个table,如订单和订单详情这两个table.</span><br><span class="line">//</span><br><span class="line">//  Created by 李泽宇 on 16/3/21.</span><br><span class="line">//  Copyright © 2016年 丶信步沧桑. All rights reserved.</span><br><span class="line"></span><br><span class="line">#import "XBViewController.h"</span><br><span class="line">#import "FMDB.h"</span><br><span class="line">#import "XBStatusBarHUD.h"</span><br><span class="line">#import "XBDatabase.h"</span><br><span class="line">#import &lt;objc/runtime.h&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@interface XBViewController ()</span><br><span class="line"></span><br><span class="line">// 属性名 对应 字段名. 因下面想练习一下runtime,顾数据库中的表的字段名与属性名保持一致,来保证条件查询时,sql语句的拼接</span><br><span class="line">@property (weak, nonatomic) IBOutlet UITextField *name;</span><br><span class="line">@property (weak, nonatomic) IBOutlet UITextField *age;</span><br><span class="line">@property (weak, nonatomic) IBOutlet UITextField *height;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">// 单例FMDatabase</span><br><span class="line">@property (nonatomic, strong) XBDatabase *db;</span><br><span class="line"></span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">@implementation XBViewController</span><br><span class="line"></span><br><span class="line">/// 懒加载</span><br><span class="line">- (FMDatabase *)db &#123;</span><br><span class="line">    </span><br><span class="line">    if (!_db) &#123;</span><br><span class="line">        </span><br><span class="line">        _db = [XBDatabase sharedDatabaseManager];</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return _db;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (void)viewDidLoad &#123;</span><br><span class="line">    </span><br><span class="line">    [super viewDidLoad];</span><br><span class="line">    </span><br><span class="line">    //访问修改数据库必须保证数据库是打开的,这样才能保证数据库的读写.</span><br><span class="line">    //打开数据库,如果没有,会创建一个数据库.</span><br><span class="line">    if (![self.db open]) &#123;</span><br><span class="line">        NSLog(@"失败");</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 拼接创建表的sql语句, 字段名与属性名一致.</span><br><span class="line">    NSString *tableString = @"CREATE TABLE IF NOT EXISTS T_Person ('Id' INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT, 'name' TEXT, 'age' INTEGER, 'height' REAL)";</span><br><span class="line">    </span><br><span class="line">    // executeUpdate: 此方法用于创建, 更新, 插入..返回值代表成功与否</span><br><span class="line">    BOOL isSuccess = [self.db executeUpdate:tableString];</span><br><span class="line">    </span><br><span class="line">    // 判断成功失败</span><br><span class="line">    if (!isSuccess) &#123;</span><br><span class="line">        [XBStatusBarHUD message:@"创表失败"];</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // XBStatusBarHUD: 还未完成的小小指示器,会在statusBar弹出一个window显示提示内容.</span><br><span class="line">    [XBStatusBarHUD message:@"创表成功"];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#pragma -Mark - 监听事件</span><br><span class="line">/// 保存/插入/添加按钮</span><br><span class="line">- (IBAction)saveButtonClick:(id)sender &#123;</span><br><span class="line"></span><br><span class="line">   // 插入数据</span><br><span class="line">    BOOL isSave = [self.db executeUpdate:@"INSERT INTO T_Person (name, age, height) VALUES (?, ?, ?)",self.name.text,self.age.text,self.height.text];</span><br><span class="line"></span><br><span class="line">    // 判断成功与否</span><br><span class="line">    if (!isSave) &#123;</span><br><span class="line">        // 回顾一下 UIAlertView, UIAlertView在iOS_9.0过期. UIAlertController iOS_8.0开始</span><br><span class="line">        if ([UIDevice currentDevice].systemVersion.doubleValue &gt;= 9.0) &#123;</span><br><span class="line">            </span><br><span class="line">            UIAlertController *alert = [UIAlertController alertControllerWithTitle:@"友情提示" message:@"保存失败" preferredStyle:UIAlertControllerStyleAlert];</span><br><span class="line">            </span><br><span class="line">            UIAlertAction *action = [UIAlertAction actionWithTitle:@"确定" style:UIAlertActionStyleDefault handler:nil];</span><br><span class="line">            </span><br><span class="line">            [alert addAction:action];</span><br><span class="line">            </span><br><span class="line">            [self presentViewController:alert animated:YES completion:nil];</span><br><span class="line">            </span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            </span><br><span class="line">            UIAlertView *alertView = [[UIAlertView alloc]initWithTitle:@"友情提示" message:@"保存失败" delegate:self cancelButtonTitle:@"确定" otherButtonTitles: nil];</span><br><span class="line"></span><br><span class="line">            [alertView show];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    [XBStatusBarHUD message:@"保存成功"];</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">/// 全部查询</span><br><span class="line">- (IBAction)queryButtonClick:(id)sender &#123;</span><br><span class="line">    </span><br><span class="line">    NSString *selectSQL = [NSString stringWithFormat:@"SELECT id, name, age, height FROM T_Person;"];</span><br><span class="line">    </span><br><span class="line">    // executeQuery: 返回一个FMResultSet类型的结果集合.</span><br><span class="line">    FMResultSet *resultAll = [self.db executeQuery:selectSQL];</span><br><span class="line">    </span><br><span class="line">    // 创表时id为 自增长 主键; 数据库若有数据,id可取值. 通过返回的resultAll调用intForColumn: 传入字段名(列名) 来查询这一列的值</span><br><span class="line">    if (![resultAll intForColumn:@"id"]) &#123;</span><br><span class="line">        </span><br><span class="line">        [XBStatusBarHUD message:@"数据库无数据"];</span><br><span class="line">        </span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    // 可通过循环调用 next 函数, 来遍历查询结果;</span><br><span class="line">    while ([resultAll next]) &#123;</span><br><span class="line">        </span><br><span class="line">        int Id = [resultAll intForColumn:@"id"];</span><br><span class="line">        </span><br><span class="line">        NSString *name = [resultAll stringForColumn:@"name"];</span><br><span class="line">        </span><br><span class="line">        int age = [resultAll intForColumn:@"age"];</span><br><span class="line">        </span><br><span class="line">        double height = [resultAll doubleForColumn:@"height"];</span><br><span class="line">        </span><br><span class="line">        NSLog(@"ID----%d, name----%@, age----%d, height----%.2f",Id, name, age, height);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// 条件查询</span><br><span class="line">- (IBAction)criteriaqueriesButtonClick:(id)sender &#123;</span><br><span class="line">   </span><br><span class="line">//    if (![self.db open]) &#123;</span><br><span class="line">//        return;</span><br><span class="line">//    &#125;</span><br><span class="line">    </span><br><span class="line">    // 拼接SQL语句, 此处拼接[self sqlString]使用运行时</span><br><span class="line">    NSString *SQL =[NSString stringWithFormat:@"SELECT * %@", [self sqlString]];</span><br><span class="line">    </span><br><span class="line">    // 查看拼接的SQL语句</span><br><span class="line">    NSLog(@"%@",SQL);</span><br><span class="line">    </span><br><span class="line">    FMResultSet *resultAll = [self.db executeQuery:SQL];</span><br><span class="line">    </span><br><span class="line">    // 判断是否查询到数据</span><br><span class="line">    if (![resultAll intForColumn:@"id"]) &#123;</span><br><span class="line">        [XBStatusBarHUD message:@"查无此项"];</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    while ([resultAll next]) &#123;</span><br><span class="line">        </span><br><span class="line">        int Id = [resultAll intForColumn:@"id"];</span><br><span class="line">        </span><br><span class="line">        NSString *name = [resultAll stringForColumn:@"name"];</span><br><span class="line">        </span><br><span class="line">        int age = [resultAll intForColumn:@"age"];</span><br><span class="line">        </span><br><span class="line">        double height = [resultAll doubleForColumn:@"height"];</span><br><span class="line">        </span><br><span class="line">        NSLog(@"ID----%d, name----%@, age----%d, height----%.2f",Id, name, age, height);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    [XBStatusBarHUD message:@"查询成功"];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// 删除语句.</span><br><span class="line">- (IBAction)deleteButtonClick:(id)sender &#123;</span><br><span class="line">    </span><br><span class="line">//    if (![self.db open]) &#123;</span><br><span class="line">//        return;</span><br><span class="line">//    &#125;</span><br><span class="line">    </span><br><span class="line">    // 字段若为TEXT = ''  一定要加单引号,不然会造成 text类型找不到错误.而INTEGER,REAL类型不会,为防止错误,所有字段的值都加''</span><br><span class="line">    NSString *deleteSQL = [NSString stringWithFormat:@"DELETE %@",[self sqlString]];</span><br><span class="line">    </span><br><span class="line">    BOOL isDelete = [self.db executeUpdate:deleteSQL];</span><br><span class="line">    </span><br><span class="line">    if (!isDelete) &#123;</span><br><span class="line">        </span><br><span class="line">        [XBStatusBarHUD message:@"删除失败"];</span><br><span class="line">        </span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    [XBStatusBarHUD message:@"删除成功"];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#pragma -Mark - Runtime 拼接字符串</span><br><span class="line">- (NSString *)sqlString &#123;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    unsigned int outCount;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    Ivar *ivars = class_copyIvarList([XBViewController class], &amp;outCount);</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    NSMutableDictionary *dictM = [[NSMutableDictionary alloc]init];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    for (int i=0; i&lt;outCount; i++) &#123;</span><br><span class="line">        </span><br><span class="line">        Ivar ivar = ivars[i];</span><br><span class="line">        </span><br><span class="line">        const char *type = ivar_getTypeEncoding(ivar);</span><br><span class="line">        </span><br><span class="line">        NSString *typeOc = [[NSString stringWithUTF8String:type] substringWithRange:NSMakeRange(2, 11)];</span><br><span class="line">        </span><br><span class="line">        if (![typeOc isEqualToString:@"UITextField"]) &#123;</span><br><span class="line">            continue;</span><br><span class="line">        &#125;</span><br><span class="line">       </span><br><span class="line">        </span><br><span class="line">        const char *field = ivar_getName(ivar);</span><br><span class="line"></span><br><span class="line">//        NSLog(@"%s",field);</span><br><span class="line">        </span><br><span class="line">        NSString *fieldString = [[NSString stringWithUTF8String:field] substringFromIndex:1];</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        UITextField *value = [self valueForKey:fieldString];</span><br><span class="line">        </span><br><span class="line">    </span><br><span class="line">        </span><br><span class="line">        if ([value.text isEqualToString:@""]) &#123;</span><br><span class="line">            continue;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">//        NSLog(@"-----%@",value.text);</span><br><span class="line">        </span><br><span class="line">        [dictM setValue:value.text forKey:fieldString];</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    NSMutableString *sqlM = [NSMutableString stringWithString:@"FROM T_Person WHERE "];</span><br><span class="line">    </span><br><span class="line">    [dictM enumerateKeysAndObjectsUsingBlock:^(id  _Nonnull key, id  _Nonnull obj, BOOL * _Nonnull stop) &#123;</span><br><span class="line">//        NSLog(@"key-%@: value-%@",key,obj);</span><br><span class="line">        </span><br><span class="line">        [sqlM appendFormat: @"%@ = '%@' AND ",key ,obj];</span><br><span class="line">        </span><br><span class="line">    &#125;];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    NSUInteger lenth = sqlM.length;</span><br><span class="line">    </span><br><span class="line">    NSRange range = NSMakeRange(0, lenth - 5);</span><br><span class="line">    </span><br><span class="line">    NSString * sql = [NSString stringWithFormat:@"%@;",[sqlM substringWithRange:range]];</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    return sql;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><a href="http://xbcs.github.io/2016/03/18/Runtime.html">Runtime链接</a></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/FMDB-iOS/">FMDB iOS</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-Runtime" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/03/18/Runtime/" class="article-date">
  	<time datetime="2015-03-18T15:05:19.000Z" itemprop="datePublished">2015-03-18</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/03/18/Runtime/">Runtime整理</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2>Classes</h2>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">1</span>.class_getName</span><br><span class="line"></span><br><span class="line">    作用<span class="symbol">:</span>获得一个类的类名;</span><br><span class="line"></span><br><span class="line">    声明<span class="symbol">:const</span> char * class_getName(Class cls)</span><br><span class="line">  </span><br><span class="line">    参数<span class="symbol">:</span>类对象(Class cls)</span><br><span class="line">  </span><br><span class="line">    <span class="symbol">return:</span> 返回一个char类型类对象的name, 如果参数是空,则返回</span><br><span class="line">             Nil;</span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">2</span>.class_getSuperclass</span><br><span class="line"></span><br><span class="line">    声明<span class="symbol">:Class</span> class_getSuperclass(Class cls)</span><br><span class="line"></span><br><span class="line">    作用<span class="symbol">:</span>获得一个类的父类</span><br><span class="line">    </span><br><span class="line">    参数<span class="symbol">:</span>类对象(Class cls);</span><br><span class="line">    </span><br><span class="line">    <span class="symbol">return:</span>返回父类类对象,如果参数是基类(如NSObject)或者Nil,返        </span><br><span class="line">           回Nil;</span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="number">3</span>.class_setSuperclass</span><br><span class="line"></span><br><span class="line">    声明<span class="symbol">:Class</span> class_setSuperclass(Class cls, Class newSuper)</span><br><span class="line">    </span><br><span class="line">    作用<span class="symbol">:</span>给传入的类设置父类;</span><br><span class="line">    </span><br><span class="line">    参数<span class="symbol">:</span>想要更改父类的类对象(Class cls), 传入的类对象(Class cls)的新的父类</span><br><span class="line">    </span><br><span class="line">    <span class="symbol">return:</span>返回传入对象的原来的父类.</span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">4</span>.class_isMetaClass</span><br><span class="line"></span><br><span class="line">    声明<span class="symbol">:BOOL</span> class_isMetaClass(Class cls)</span><br><span class="line">    </span><br><span class="line">    作用<span class="symbol">:</span>判断一个对象是否是元类</span><br><span class="line">    </span><br><span class="line">    参数<span class="symbol">:</span>类对象</span><br><span class="line">    </span><br><span class="line">    <span class="symbol">return:</span> 若参数类对象是元类返回YES;若不是或参数类对象为Nil,返回Nil</span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span>.class_getInstanceSize</span><br><span class="line"></span><br><span class="line">    声明<span class="symbol">:size_t</span> class_getInstanceSize(Class cls)</span><br><span class="line"></span><br><span class="line">    作用<span class="symbol">:</span>返回一个实例对象的大小 单位是byte</span><br><span class="line">    </span><br><span class="line">    参数<span class="symbol">:</span>类对象</span><br><span class="line">    </span><br><span class="line">    <span class="symbol">return:</span>返回类对象的大小,单位为byte.若参数为Nil,返回<span class="number">0</span></span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span>.class_getInstanceVariable</span><br><span class="line"></span><br><span class="line">    声明<span class="symbol">:Ivar</span> class_getInstanceVariable(Class cls, const char* name)</span><br><span class="line">    </span><br><span class="line">    作用<span class="symbol">:</span>获得传入的类对象的指定name的实例变量;</span><br><span class="line">    </span><br><span class="line">    参数<span class="symbol">:</span>类对象(Class cls), 传入类对象的实例变量的名称(const char* name)</span><br><span class="line">    </span><br><span class="line">    <span class="symbol">return:</span> 返回一个指针,指向传入类对象的指定name的实例变量.Ivar指针包含有变量的信息，名字，类型，及距离一个对象实例本身地址的偏移.</span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">7</span>.class_getClassVariable --- OC中好像没有类实例变量?</span><br><span class="line"></span><br><span class="line">    声明<span class="symbol">:Ivar</span> class_getClassVariable(Class cls, const char* name)</span><br></pre></td></tr></table></figure>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">8.class_addIvar</span><br><span class="line"></span><br><span class="line">    声明:BOOL class_addIvar(Class cls, const char *name, size_t size, uint8_t alignment, const char *types)</span><br><span class="line">    </span><br><span class="line">    作用:给一个类添加一个新的实例变量</span><br><span class="line">    </span><br><span class="line">    官方文档:This function may only be called after objc_allocateClassPair and before objc_registerClassPair. Adding an instance variable to an existing class is not supported.</span><br><span class="line">    </span><br><span class="line">            这个函数只能用在objc_allocateClassPair 和 before objc_registerClassPair之间,并且不能给一个已经存在的类添加实例变量;</span><br><span class="line"></span><br><span class="line">            The class must not be a metaclass. Adding an instance variable to a metaclass is not supported.</span><br><span class="line"></span><br><span class="line">            这个类不能是元类,不支持给元类添加成员变量;</span><br><span class="line"></span><br><span class="line">            The instance variable's minimum alignment in bytes is 1&lt;&lt;align. The minimum alignment of an instance variable depends on the ivar's type and the machine architecture. For variables of any pointer type, pass log2(sizeof(pointer_type)).</span><br><span class="line">            这个实例变量的最小字节数是1&lt;&lt;align. 这上边写的什么玩意,特么看不懂.</span><br><span class="line">    </span><br><span class="line">    参数: 1.想要动态添加新成员变量的类对象.</span><br><span class="line">         2.新的实例变量的name.</span><br><span class="line">         3.实例变量的大小</span><br><span class="line">         4.alignment</span><br><span class="line">         5.参考&lt;a&gt;https://developer.apple.com/library/mac/documentation/Cocoa/Conceptual/ObjCRuntimeGuide/Articles/ocrtTypeEncodings.html&gt;类型编码&lt;/a&gt;</span><br><span class="line">    参数3,4 可通过以下代码获得(NSGetSizeAndAlignment("*", &amp;size, &amp;alignment);)  //"*" const char *types 见上述类型编码</span><br><span class="line">    NSUInteger size;</span><br><span class="line">    NSUInteger alignment;</span><br><span class="line">    NSGetSizeAndAlignment("*", &amp;size, &amp;alignment);</span><br><span class="line">    创建两个NSUInteger变量,传入地址.得到两个变量值.</span><br><span class="line">    </span><br><span class="line">    return: 添加成功返回YES.失败NO.</span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">9</span>.class_copyIvarList</span><br><span class="line"></span><br><span class="line">    声明<span class="symbol">:Ivar</span> * class_copyIvarList(Class cls, unsigned int *outCount)</span><br><span class="line">    </span><br><span class="line">    作用<span class="symbol">:</span>获取传入类的所有属性和实例变量,及实例变量总个数</span><br><span class="line">    </span><br><span class="line">    参数<span class="symbol">:</span>类对象, 传入无符号整形变量地址.返回实例变量总个数</span><br><span class="line">    </span><br><span class="line">    <span class="symbol">return:</span>返回一个指针数组,数组储存所有实例变量的Ivar指针(见<span class="number">6</span>.<span class="symbol">return:</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">10</span>.class_getProperty</span><br><span class="line"></span><br><span class="line">    声明<span class="symbol">:objc_property_t</span> class_getProperty(Class cls, const char *name)</span><br><span class="line">    </span><br><span class="line">    作用<span class="symbol">:</span>返回传入类的指定属性.</span><br><span class="line">    </span><br><span class="line">    参数<span class="symbol">:</span>类对象, 属性名</span><br><span class="line">    </span><br><span class="line">    <span class="symbol">return:</span>objc_property_t类型的指针</span><br></pre></td></tr></table></figure>
<h2>运行时常用函数</h2>



<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>&gt; &lt;objc/runtime.h&gt;</span><br><span class="line">* Method class_getClassMethod(Class cls,SEL name)</span><br><span class="line">获得某个类的类方法</span><br><span class="line"></span><br><span class="line">* Method class_getInstanceMethod(Class cls,SEL name)</span><br><span class="line">获得某个类的对象方法</span><br><span class="line"></span><br><span class="line">* void method_exchangeImplementations(Method m1, Method m2) </span><br><span class="line">交换<span class="number">2</span>个方法的实现(重点,iOS 中的黑魔法Swizzle)</span><br><span class="line"></span><br><span class="line">* void objc_setAssociatedObject(id object, const void *key, id value, objc_AssociationPolicy policy)</span><br><span class="line">将值value根对象object关联起来(将值value存贮到对象object中)</span><br><span class="line">参数<span class="symbol">key:</span> 将来可以通过key去除这个存储的值</span><br><span class="line">参数<span class="symbol">policy:</span> 存贮策略(assign,copy,retain)</span><br><span class="line"></span><br><span class="line">* id objc_getAssociatedObject(id object,sonst void *key)</span><br><span class="line">利用参数key将对象object中存储的对应值取出来</span><br><span class="line"></span><br><span class="line">* Ivar *class_copyIvarList(Class cls, unsigned int *outCount) </span><br><span class="line">获得某各类的所有成员变量(outCount会返回所有成员变量的总数)</span><br><span class="line"></span><br><span class="line">* const char *ivar_getName(Ivar v) </span><br><span class="line">获得成员变量的名字</span><br><span class="line"></span><br><span class="line">* const char *ivar_getTypeEncoding(Ivar v) </span><br><span class="line">获得成员变量的类型</span><br><span class="line"></span><br><span class="line">* void	 free(void *);</span><br><span class="line">释放内存</span><br><span class="line">(当C语言函数名中包含了copy,create,retai,new等词语,都需要在最后释放资源)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>&gt; &lt;objc/message.h&gt;</span><br><span class="line">* void objc_msgSend(void)</span><br><span class="line">给某个对象发送某个消息</span><br></pre></td></tr></table></figure>
<h2>运行时常见应用</h2>

<ul>
<li>动态添加对象的成员变量和成员方法</li>
<li>动态交换两个方法的实现(特别是交换系统自带的方法)</li>
<li>获得某个类的所有成员方法,所有成员变量</li>
</ul>
<p>–</p>
<p></p><h2>代码</h2><p></p>
<h4>动态交换两个方法的实现(特别是交换系统自带的方法)</h4>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">//交换方法实现</span><br><span class="line">    Method m1 = class_getClassMethod([Person class], @selector(run));</span><br><span class="line">    Method m2 = class_getClassMethod([Person class], @selector(study));</span><br><span class="line">    method_exchangeImplementations(m1, m2);</span><br></pre></td></tr></table></figure>
<p>-</p>
<h4>交换方法实现,兼容版本具体应用</h4>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">#import "UIImage+Extension.h"</span><br><span class="line">#import &lt;objc/runtime.h&gt;</span><br><span class="line"></span><br><span class="line">@implementation UIImage (Extension)</span><br><span class="line">//交换方法</span><br><span class="line">+(void)load&#123;</span><br><span class="line">    Method m1 = class_getClassMethod([UIImage class], @selector(imageNamed:));</span><br><span class="line">    Method m2 = class_getClassMethod([UIImage class], @selector(ac_imageNamed:));</span><br><span class="line">    method_exchangeImplementations(m1, m2);</span><br><span class="line">&#125;</span><br><span class="line">+(UIImage *)ac_imageNamed:(NSString *)name&#123;</span><br><span class="line">    double version = [[[UIDevice currentDevice] systemVersion]doubleValue];</span><br><span class="line">    if (version &gt;= 7.0) &#123;</span><br><span class="line">        name = [NSString stringWithFormat:@"%@_iOS7",name];</span><br><span class="line">    &#125;</span><br><span class="line">    return [UIImage ac_imageNamed:name];</span><br><span class="line">&#125;</span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>-</p>
<h4>给分类增加属性</h4>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#import &lt;Foundation/Foundation.h&gt;</span></span><br><span class="line"></span><br><span class="line">@interface NSObject (Extension)</span><br><span class="line">@property(nonatomic,copy)NSString *name;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#import "NSObject+Extension.h"</span></span><br><span class="line"><span class="comment">#import &lt;objc/runtime.h&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@implementation NSObject (Extension)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">char NameKey;</span><br><span class="line">-(void)<span class="symbol">setName:</span>(NSString *)name&#123;</span><br><span class="line">    </span><br><span class="line">    objc_setAssociatedObject(<span class="keyword">self</span>, &amp;NameKey, name, OBJC_ASSOCIATION_COPY_NONATOMIC);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-(NSString *)name&#123;</span><br><span class="line">    <span class="keyword">return</span>  objc_getAssociatedObject(<span class="keyword">self</span>, &amp;NameKey);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></table></figure>
<p>-</p>
<h4>获取类的所有成员变量</h4>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">unsigned int outCount = 0;</span><br><span class="line">    //获得Dog类的所有成员变量</span><br><span class="line">    Ivar *ivars = class_copyIvarList([Dog class], &amp;outCount);</span><br><span class="line">    // 遍历所有的成员变量</span><br><span class="line">    for (int i = 0; i &lt; outCount; i++) &#123;</span><br><span class="line">        Ivar ivar = ivars[i];</span><br><span class="line">        const char *name =  ivar_getName(ivar);</span><br><span class="line">        const char *type = ivar_getTypeEncoding(ivar);</span><br><span class="line">        NSLog(@"%s %s",name,type);</span><br><span class="line">    &#125;</span><br><span class="line">    //释放内存</span><br><span class="line">    free(ivars);</span><br><span class="line">    </span><br><span class="line">    NSLog(@"%zd",outCount);</span><br></pre></td></tr></table></figure>
<p>-</p>
<h4>运行KVC时归档解档</h4>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line">#import "Dog.h"</span><br><span class="line">#import &lt;objc/runtime.h&gt;</span><br><span class="line">@interface Dog : NSObject&lt;NSCoding&gt;</span><br><span class="line">@property (nonatomic, copy) NSString *name;</span><br><span class="line">@property (nonatomic, assign) int age;</span><br><span class="line">@property (nonatomic, assign) double height;</span><br><span class="line">@property (nonatomic, assign) double weight;</span><br><span class="line">@property (nonatomic, assign) double aaa;</span><br><span class="line">@property (nonatomic, assign) double bbb;</span><br><span class="line">@property (nonatomic, assign) double ccc;</span><br><span class="line">@end</span><br><span class="line"></span><br><span class="line">#import "Dog.h"</span><br><span class="line">#import &lt;objc/runtime.h&gt;</span><br><span class="line">@implementation Dog</span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> 这个数据的成员变量,不会被归档和解档</span><br><span class="line"> */</span><br><span class="line">-(NSArray *)ignoredNames&#123;</span><br><span class="line">    return @[@"_aaa",@"_bbb",@"_ccc"];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// 从文件中读取对象时会调用这个方法(说明需要读取的属性)</span><br><span class="line">-(instancetype)initWithCoder:(NSCoder *)aDecoder&#123;</span><br><span class="line">    </span><br><span class="line">    if (self = [super init]) &#123;</span><br><span class="line">        </span><br><span class="line">        //用来存储成员变量的数量</span><br><span class="line">        unsigned int outCount = 0;</span><br><span class="line">        </span><br><span class="line">        //获得Dog类的所有成员变量</span><br><span class="line">        Ivar *ivars = class_copyIvarList([self class], &amp;outCount);</span><br><span class="line">        </span><br><span class="line">        // 遍历所有的成员变量</span><br><span class="line">        for (int i = 0; i &lt; outCount; i++) &#123;</span><br><span class="line">            // 取出i位置对应的成员变量</span><br><span class="line">            Ivar ivar = ivars[i];</span><br><span class="line">            </span><br><span class="line">            NSString *key =  [NSString stringWithUTF8String:ivar_getName(ivar)];</span><br><span class="line">            //忽略解档对象</span><br><span class="line">            if ([[self ignoredNames] containsObject:key])</span><br><span class="line">                continue;</span><br><span class="line">            //获得key对应的值</span><br><span class="line">            id value = [aDecoder decodeObjectForKey:key];</span><br><span class="line">            </span><br><span class="line">            //设置到成员变量上</span><br><span class="line">            [self setValue:value forKeyPath:key];</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        //释放内存</span><br><span class="line">        free(ivars);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    return self;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/// 将对象写入文件时会调用这个方法(说明哪个属性需要存储)</span><br><span class="line">-(void)encodeWithCoder:(NSCoder *)aCoder&#123;</span><br><span class="line">    </span><br><span class="line">    //用来存储成员变量的数量</span><br><span class="line">    unsigned int outCount = 0;</span><br><span class="line">    //获得Dog类的所有成员变量</span><br><span class="line">    Ivar *ivars = class_copyIvarList([self class], &amp;outCount);</span><br><span class="line">    // 遍历所有的成员变量</span><br><span class="line">    for (int i = 0; i &lt; outCount; i++) &#123;</span><br><span class="line">        Ivar ivar = ivars[i];</span><br><span class="line">        NSString *key =  [NSString stringWithUTF8String:ivar_getName(ivar)];</span><br><span class="line">        //忽略归档对象</span><br><span class="line">        if ([[self ignoredNames] containsObject:key])</span><br><span class="line">            continue;</span><br><span class="line">        id value = [self valueForKeyPath:key];</span><br><span class="line">        </span><br><span class="line">        [aCoder encodeObject:value forKey:key];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    //释放内存</span><br><span class="line">    free(ivars);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//viewController点击方法</span><br><span class="line">-(void)touchesBegan:(NSSet&lt;UITouch *&gt; *)touches withEvent:(UIEvent *)event&#123;</span><br><span class="line">    </span><br><span class="line">    Dog *dog1 = [[Dog alloc]init];</span><br><span class="line">    dog1.age = 20;</span><br><span class="line">    dog1.height = 1.55;</span><br><span class="line">    dog1.name = @"wangcai";</span><br><span class="line">    dog1.weight = 50;</span><br><span class="line">    //将dog归档到桌面</span><br><span class="line">    [NSKeyedArchiver archiveRootObject:dog1 toFile:@"/Users/Chenzhaoshen/Desktop/dog.hm"];</span><br><span class="line">    </span><br><span class="line">    //解档</span><br><span class="line">    Dog *dog = [NSKeyedUnarchiver unarchiveObjectWithFile:@"/Users/Chenzhaoshen/Desktop/dog.hm"];</span><br><span class="line">    NSLog(@"%@,%d,%f,%f",dog.name,dog.age,dog.height,dog.weight);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>-</p>
<p>待续…</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/objc-OC-Runtime/">objc OC Runtime</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
    <article id="post-存了很长时间的一点随记" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/03/07/存了很长时间的一点随记/" class="article-date">
  	<time datetime="2015-03-07T15:05:19.000Z" itemprop="datePublished">2015-03-07</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/03/07/存了很长时间的一点随记/">存了很长时间的一点随记</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1>随记</h1>

<p>1.ios9之后默认不支持http, 要求必须是https 并且服务器HTTP协议必须使用1.2版本及以上.<br>         https 在传输数据时 通过二进制层级加密. 传输的是加密数据.</p>
<pre><code>要禁止Ios9阻止 不安全传输.
在Info 中,app Transport Security Settings 添加一个子类 如图.设置YES
</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/1431417-e96e8e4aefe5fe28.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Snip20160307_3.png"></p>
<p>或右键info.plist 用原代码的方式打开并输入</p>
<p><img src="http://upload-images.jianshu.io/upload_images/1431417-3f6494ec469702b2.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Snip20160307_6.png"><br><img src="http://upload-images.jianshu.io/upload_images/1431417-2a8f9c05e0d2dd62.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Snip20160307_7.png"><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">   &lt;key&gt;NSAppTransportSecurity&lt;/key&gt;</span><br><span class="line">    &lt;dict&gt;</span><br><span class="line">        &lt;key&gt;NSAllowsArbitraryLoads&lt;/key&gt;</span><br><span class="line">        &lt;true/&gt;</span><br><span class="line">    &lt;/dict&gt;</span><br></pre></td></tr></table></figure></p>
<pre><code>2.在Iphone中 上传 字符串形式的二进制图片,上传不成功, 解决办法:base64编码
</code></pre><hr>
<pre><code>3.封装了一个NSURLConectionDataDelegete 下载,但
</code></pre><hr>
<pre><code>4.swift 1.2中范围用 0..9    在2.0中用0...9
</code></pre><hr>
<pre><code>5.一定不要相信自己的代码是正确的,想办法测试一下.避免错误
</code></pre><hr>
<pre><code>6.在scrollView及其子类下使用 touchbegin 不会被调用.
 因为scrollView 中有手势,而手势是对touch的封装,所以往往有手势的地方会屏蔽touch的使用.
</code></pre><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">7.多线程, 完成回调在主线程执行代码的方法:</span><br><span class="line">&gt;1.  [self performSelectorOnMainThread: withObject: waitUntilDone:];</span><br><span class="line">&gt;2.  [self performSelector: OnThread:[NSThread mainThread] withObject: waitUntilDone:  ]</span><br><span class="line">&gt;3.   dispatch_async(dispatch_get_main_queue(),^&#123;&#125;)</span><br></pre></td></tr></table></figure>
<hr>
<pre><code>8.子控件的alpha值 不能比 父控件的高; 若子控件alpha值大于父控件alpha值 则以父控件为基准.
</code></pre><hr>
<pre><code>9.如果layer.contents中的像素超出了contents的边界 那么contents支持向外延伸显示.(在此感谢Jayden)
</code></pre><p><img src="http://upload-images.jianshu.io/upload_images/1431417-7d4f64a62f0d5d54.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Snip20160307_10.png"></p>
<pre><code>大致意思是: 如果需要像素显示在长方形之外, contents image 将会支持延伸..
信步英语水平大概3.1级,请将就..
</code></pre><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">10.消息转发机制</span><br><span class="line"></span><br><span class="line">    运行时</span><br><span class="line">调用方法意味着发送消息</span><br><span class="line"></span><br><span class="line">//导入框架 &lt;objc/runtime.h&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">1&gt;.自己做一些处理</span><br><span class="line">    +(BOOL)resolveInstanceMethod:(SEL)sel&#123;</span><br><span class="line"></span><br><span class="line">        if(self==@selector(run))&#123;</span><br><span class="line"></span><br><span class="line">        class_addMethod(self,sell,(IMP)eat,@)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2&gt;.实现消息转发</span><br><span class="line">-(id)forwardingTargetForSelector:(SEL)aSelector&#123;</span><br><span class="line">return [[Cat alloc]init];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">3&gt;.完整消息转发</span><br><span class="line">// 给方法加个签名</span><br><span class="line"></span><br><span class="line">-(NSMethodSignature *)methhodSignatureForSelector:(SEL)aSelector&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<pre><code>11.UIAlerViewController 中 的style属性中 取消style  --  Cancle 只能有一个. 否则会崩溃;
</code></pre><hr>
<pre><code>12.UIWindow 的显示: 显示最后一个hidden为NO的 window;  并不是显示keyWindow;  覆盖; 创建Window,hidden属性默认为YES;
</code></pre><hr>
<pre><code>13.description方法是 NSObject的 对象方法 +(NSString *)description;   NSLog中 通过%@ 打印对象 就是调用的description方法;
 重写此方法时,不要在此方法内同时写 &quot;%@&quot;,&apos;&apos;self&apos;&apos;  会死递归
</code></pre><hr>
<pre><code>14.tabBarController中 通过 自身 viewControllers 数组属性的角标 实现跳转,没有modal  show  push方法;      push是NavigationController的自有方法.
</code></pre><hr>
<pre><code>15.修改tabBar或者tabBarItem中的 setTintColor 属性 会把系统默认的两个控制条的渲染颜色都更改;
</code></pre><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">16.字典的枚举遍历</span><br><span class="line">    enumerateKeysAndObjectsWithOptions: usingBlock:</span><br><span class="line">    enumerateKeysAndObjectsUsingBlock:</span><br></pre></td></tr></table></figure>
<hr>
<pre><code>17.分类中不能添加成员变量{NSString *sdf}     能添加属性( @property) 但是要自己实现set get方法  分类中添加属性的其实只是添加了set get方法的声明;
</code></pre><hr>
<pre><code>18.Dealloc在哪个线程执行?

一个对象的dealloc方法会在该对象的引用计数变为0 的线程被调用;
</code></pre><hr>
<pre><code>19.在.m中创建的@property 实例变量 可用KVC拿到.(运行时)
</code></pre><hr>
<pre><code>20.info.plist文件设置
</code></pre><p>不懂英文,一直在欧陆,就不翻译了…附<a href="https://developer.apple.com/library/mac/documentation/General/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html#//apple_ref/doc/uid/TP40009252-SW2" target="_blank" rel="external">iOS keys 官方文档</a></p>
<hr>
<p>21.应用程序启动原理</p>
<p><a href="http://www.cnblogs.com/wendingding/p/3766347.html" target="_blank" rel="external">这是一篇关于程序启动原理和UIApplication的博客</a></p>
<hr>
<pre><code>22.NSOperation 的依赖关系  可以根据UI界面的顺序来实现优先下载;
</code></pre><hr>
<pre><code>23.NSSeesion 可后台下载,也可在程序关闭之后下载;
</code></pre><hr>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">24</span>.</span><br><span class="line">double version = [[UIDevice currentDevice].systemVersion doubleValue];<span class="regexp">//</span>表示当前版本号;</span><br></pre></td></tr></table></figure>
<hr>
<pre><code>25.方法 + (void)load :当某个类或者某个分类加载进内存中时 调用一次; (只会加载一次所以只会调用一次);
加载实在编译时进行的,只要程序中包含某个类的头文件,就会被加载.
</code></pre><hr>
<pre><code>26.block 使用 copy 是从 MRC 遗留下来的“传统”,在 MRC 中,方法内部的 block 是在栈区的,使用 copy 可以把它放到堆区.在 ARC 中写不写都行：对于 block 使用 copy 还是 strong 效果是一样的，但写上 copy 也无伤大雅，还能时刻提醒我们：编译器自动对 block 进行了 copy 操作。如果不写 copy ，该类的调用者有可能会忘记或者根本不知道“编译器会自动对 block 进行了 copy 操作”，他们有可能会在调用之前自行拷贝属性值。这种操作多余而低效。
</code></pre><p>转载..应该是<a href="https://github.com/ChenYilong/iOS9AdaptationTips" target="_blank" rel="external">ChenYilong</a>大牛的,链接就只附到这吧…具体地址烦请自行查找,更能学习很多东西;</p>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">27.测试动画时间</span><br><span class="line">let anim = toolbar.layer.animationForKey(&quot;position&quot;)</span><br><span class="line">print(&quot;动画时长 \(anim?.duration)&quot;)</span><br></pre></td></tr></table></figure>
<hr>
<pre><code>28.给uiview添加MotionEffect

就像在Home页的壁纸，随着手机角度移动，壁纸会动。

好像是iOS7出现的.
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UIInterpolatingMotionEffect * xEffect = [[UIInterpolatingMotionEffect alloc] initWithKeyPath:@&quot;center.x&quot; type:UIInterpolatingMotionEffectTypeTiltAlongHorizontalAxis];</span><br><span class="line">xEffect.minimumRelativeValue =  [NSNumber numberWithFloat:-40.0];</span><br><span class="line">xEffect.maximumRelativeValue = [NSNumber numberWithFloat:40.0];</span><br><span class="line">[img addMotionEffect:xEffect];</span><br></pre></td></tr></table></figure>
<hr>
<pre><code>29.获取正在运行的程序
</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">#import &lt;sys/sysctl.h&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">- (NSArray *)runningProcesses &#123;</span><br><span class="line">    </span><br><span class="line">    int mib[4] = &#123;CTL_KERN, KERN_PROC, KERN_PROC_ALL, 0&#125;;</span><br><span class="line">    size_t miblen = 4;</span><br><span class="line">    </span><br><span class="line">    size_t size;</span><br><span class="line">    int st = sysctl(mib, miblen, NULL, &amp;size, NULL, 0);</span><br><span class="line">    </span><br><span class="line">    struct kinfo_proc * process = NULL;</span><br><span class="line">    struct kinfo_proc * newprocess = NULL;</span><br><span class="line">    </span><br><span class="line">    do &#123;</span><br><span class="line">        </span><br><span class="line">        size += size / 10;</span><br><span class="line">        newprocess = realloc(process, size);</span><br><span class="line">        </span><br><span class="line">        if (!newprocess)&#123;</span><br><span class="line">            </span><br><span class="line">            if (process)&#123;</span><br><span class="line">                free(process);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            return nil;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        process = newprocess;</span><br><span class="line">        st = sysctl(mib, miblen, process, &amp;size, NULL, 0);   </span><br><span class="line"></span><br><span class="line">       &#125; while (st == -1 &amp;&amp; errno == ENOMEM);if (st == 0)&#123;</span><br><span class="line">        </span><br><span class="line">        if (size % sizeof(struct kinfo_proc) == 0)&#123;</span><br><span class="line">            int nprocess = size / sizeof(struct kinfo_proc);</span><br><span class="line">            </span><br><span class="line">            if (nprocess)&#123;</span><br><span class="line">                </span><br><span class="line">                NSMutableArray * array = [[NSMutableArray alloc] init];</span><br><span class="line">                </span><br><span class="line">                for (int i = nprocess - 1; i &gt;= 0; i--)&#123;</span><br><span class="line">                    </span><br><span class="line">                    NSString * processID = [[NSString alloc]initWithFormat:</span><br><span class="line">                                          @&quot;%d&quot;, process[i].kp_proc.p_pid];</span><br><span class="line"></span><br><span class="line">                    NSString * processName = [[NSString alloc]initWithFormat:</span><br><span class="line">                                           @&quot;%s&quot;, process[i].kp_proc.p_comm];</span><br><span class="line">                    </span><br><span class="line">                    NSDictionary * dict = [[NSDictionary alloc]initWithObjects</span><br><span class="line">                        :[NSArray arrayWithObjects:processID, processName</span><br><span class="line">                                     ,nil] forKeys:[NSArray arrayWithObjects:</span><br><span class="line">                                                         @&quot;ProcessID&quot;, </span><br><span class="line">                                                         @&quot;ProcessName&quot;,</span><br><span class="line">                                                         nil]];</span><br><span class="line">                   </span><br><span class="line">                    [array addObject:dict];</span><br><span class="line">                &#125;</span><br><span class="line">                </span><br><span class="line">                free(process);</span><br><span class="line">                return array;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    return nil;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"> NSArray * processes = [self runningProcesses];</span><br><span class="line">    for (NSDictionary * dict in processes)&#123;</span><br><span class="line">        NSLog(@&quot;%@ - %@&quot;, [dict objectForKey:@&quot;ProcessID&quot;],</span><br><span class="line">                           [dict objectForKey:@&quot;ProcessName&quot;]);</span><br><span class="line">    &#125;</span><br><span class="line">获取所有已经安装的app</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;objc/runtime.h&gt;</span><br><span class="line"></span><br><span class="line">Class LSApplicationWorkspace_class=objc_getClass(&quot;LSApplicationWorkspace&quot;);</span><br><span class="line"></span><br><span class="line">NSObject* workspace = [LSApplicationWorkspace_class performSelector:</span><br><span class="line">@selector(defaultWorkspace)];</span><br><span class="line"></span><br><span class="line">NSLog(@&quot;apps: %@&quot;, [workspace performSelector:@selector(allApplications)]);</span><br><span class="line"></span><br><span class="line">转载..当时直接copy了...链接就....</span><br></pre></td></tr></table></figure>
<hr>
<pre><code>30.NSNotification必须配对出现


NSNotification有add，必须在dealloc中remove，否则会造成循环引用。另外注意 NSNotification 中的target是阻塞执行的。执行的线程和poster(发送者)一致，如果想更新UI，注意应在main_thread中执行。
</code></pre><hr>
<pre><code>31.NSTimer 的引用问题: 记得invalidate

必须清除NSTimer，否则造成循环引用
</code></pre><hr>
<pre><code>32.滑动的时候隐藏navigationbar

    navigationController.hidesBarsOnSwipe = Yes
</code></pre><hr>
<pre><code>33.多态   父类指针可以接收实例化子类  如 界面传值.  

    UIViewController = segue.destinationViewController;
    这里的segue.destinationViewController  可能是一个任意的UIViewController的子类;
</code></pre><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">34.重写set方法 参数可以随机, 下面是重写了UIImage *image的set方法.</span><br><span class="line">- (void)setImage:(NSString *)image &#123;</span><br><span class="line">    if (_image != [UIImage imageNamed: image]) &#123;</span><br><span class="line">         [_image release];</span><br><span class="line">          _image = [[UIImage imageNamed: image] retain];</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<hr>
<pre><code>35.UIControl 的子类: UIButton UIPickerControl  segmentControl 等
</code></pre><hr>
<pre><code>36.修改tabBar或者tabBarItem中的 setTintColor 属性 会把系统默认的两个控制条的渲染颜色都更改;
</code></pre><hr>
<pre><code>37.分类可以添加属性,但系统不会帮我们自动创建带下划线的实例变量也不会帮我们实现 set get方法, 只会声明set get方法;
</code></pre><hr>
<pre><code>38.Button  的contentEdgeInsets,imageEdgeInsets,titleEdgeInsets属性 可改变Button图片的偏移位置. 甚至可超出button的范围显示,详见第9条;
</code></pre><hr>
<pre><code>39.UIImageView 中 animationImages 数组可添加 动画图片; 并通过设置动画执行时间属性animationDuration 和 动画重复次数animationRepeatCount 来设置动画. 再手动调用开始动画,即可实现动画效果 [imageView startAnimating];
</code></pre><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">40.设置button中 image属性图片 的拉伸形式:</span><br><span class="line">    1&gt;.加载背景图片 </span><br><span class="line">    2&gt;.更改模式 </span><br><span class="line">    3&gt;.设置给button</span><br><span class="line"></span><br><span class="line">     1).UIImage *image;   </span><br><span class="line"></span><br><span class="line"> //若只想把图片部分拉伸，而不是全部拉伸，就要用此函数</span><br><span class="line">  2).[image sretchableImageWithLiftCapWidth:  toCapHight:] </span><br><span class="line">//leftCapWidth:左侧不拉伸区域</span><br><span class="line">//topCapHeight:上方不拉伸区域</span><br><span class="line"></span><br><span class="line"> 3).添加</span><br></pre></td></tr></table></figure>
<hr>
<pre><code>41.这是以前记下的找了一上午的Bug,留念..
使用storyBoard加载多控制器不能用alloc init  需要先加载storyBoard 然后通过storyBoard instentiate加载一个控制器. 这样创建的控制器才能加载到你搭建的界面;
</code></pre><hr>
<pre><code>42.添加子控制器的 push方法是导航控制器的方法,只有导航控制器及子类可以使用; show方法是UIViewController的,所有继承自他都可以使用.
</code></pre><hr>
<pre><code>43.modal 与 push    有关联用push   有关联指的是 UINavigationController子控制器;
</code></pre><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">    44.统一设置导航栏颜色或 其他全局的外观,需要在AppDelegate中 通过外观代理获取自身的对象 来设置. 外观代理: appearance   </span><br><span class="line">例如统一设置导航栏外观:</span><br><span class="line"></span><br><span class="line">UINavigationBar *bar = [UINavigationBar appearance];    </span><br><span class="line"></span><br><span class="line">[bar setBackgroundImage:[UIImage imageNamed:@&quot;NavBar64&quot;] forBarMetrics:UIBarMetricsDefault];  </span><br><span class="line">NSDictionary *dict = @&#123;NSForegroundColorAttributeName:[UIColor whiteColor]&#125;;    </span><br><span class="line">[bar setTitleTextAttributes:dict];</span><br><span class="line">[bar setTintColor:[UIColor whiteColor]];</span><br></pre></td></tr></table></figure>
<hr>
<pre><code>45.应用程序启动先执行main函数,根据第三个参数创建 UIApplication根据第四个参数创建AppDelegate并赋值给application的delegate属性,然后根据info.plist加载Main.storyboard及LaunchScreen.storyboard 若没有指定Main.storyboard 就会进入AppDelegate 执行application: didFinishLaunchingWithOptions: 
</code></pre><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">    46.如何保持图片最原始的效果，不要渲染</span><br><span class="line"></span><br><span class="line">[image imageWithRenderingMode:UIImageRenderingModeAlwaysOriginal];</span><br></pre></td></tr></table></figure>
<hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">47.</span><br><span class="line"></span><br><span class="line">// 没想到什么,暂用字典转模型随便写一下..</span><br><span class="line"></span><br><span class="line">#import &quot;XBModel&quot;</span><br><span class="line"></span><br><span class="line">@implementation XBModel</span><br><span class="line">// 此为父类方法</span><br><span class="line">+ (instanstype)modelWithDict &#123;</span><br><span class="line"></span><br><span class="line">     id obj = [[self alloc]init];</span><br><span class="line">          [obj setValuesForKeysWithDictionary:dict];</span><br><span class="line">     </span><br><span class="line">      return obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">子类中: //</span><br><span class="line">      若子类没有重写父类方法,那么调用父类的方法,父类中不使用[self alloc]创建,直接用[XBModel alloc]</span><br><span class="line">      会返回一个父类对象,使子类指针指向父类.</span><br><span class="line"> </span><br><span class="line">      若是只用self则会 父类指针指向子类对象. 即用id又用self则会很灵活,因为返回值是instanstype.</span><br></pre></td></tr></table></figure>
<hr>
<pre><code>48.block速记符号: inline block,能够快速敲出一个block的基本结构
</code></pre><hr>
<pre><code>49.队列优先级被设置成 DISPATCH_QUEUE_PRIORITY_BACKGROUND之后,会被设置成后台级别的队列，它会等待所有比它级别高的队列中的任务执行完或CPU空闲的时候才会执行自己的任务。例如磁盘的读写操作非常耗时，如果我们不需要立即获取到磁盘的数据，我们可以把读写任务放到后台队列中，这样读写任务只会在恰当的时候去执行而不会影响需要更改优先级的其他任务，整个程序也会更加有效率。
</code></pre><hr>
<pre><code>50.viewDidLoad中 还没有进行自动布局,所以控件的Frame是设置的Frame, 而viewDidLayoutSubviews里执行完[super viewDidLayoutSubviews]之后,才是布局后的真正想要的Frame;也可在后续的viewDidApear等controller生命周期方法中获得
</code></pre><hr>
<pre><code>51.Block   本质是结构体,指向结构体的指针
</code></pre><hr>
<pre><code>52.模型继承于NSObject 为了使用KVC
</code></pre><hr>
<pre><code>53.ctr +r 缩排
</code></pre><hr>
<pre><code>54.四句话讲明白Swift闭包:

    1&gt;闭包是一段准备好的代码块,在需要的时候执行
    2&gt;闭包是没有名字的函数
    3&gt;函数是有名字的闭包
    4&gt;只要类型就可以赋值

    Swift中没有指针的概念
</code></pre><hr>
<pre><code>55.重写属性的set方法 不仅可在 赋值之后做一些事情 也可根据需求在赋值之前做一些事情.  Swift 中对应 didSet{}   willSet{}
</code></pre><hr>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">56</span>.</span><br><span class="line"></span><br><span class="line">[[UIImage <span class="symbol">imageNamed:</span>@<span class="string">"uusername"</span>] <span class="symbol">imageWithRenderingMode:</span>UIImageRenderingModeAlwaysOriginal];</span><br><span class="line"><span class="regexp">//</span>图片是白色,代码之后显示绿色,  加上</span><br><span class="line"><span class="symbol">imageWithRenderingMode:</span>UIImageRenderingModeAlwaysOriginal后显示正常</span><br></pre></td></tr></table></figure>
<p><a href="http://www.jianshu.com/p/286cc5d2f707" target="_blank" rel="external">简书链接</a></p>
<hr>

      
    </div>
    
    <div class="article-info article-info-index">
      
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/OC-知识点-随记/">OC 知识点 随记</a></li></ul>
	</div>

      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>









  
  
    <nav id="page-nav">
      <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span>
    </nav>
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2016 Zoe Lee
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">


<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: true,
		isPost: false,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>
<script src="http://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>






<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  </div>
</body>
</html>